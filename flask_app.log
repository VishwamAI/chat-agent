2024-06-19 10:50:48,389 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, world!'}
2024-06-19 10:50:48,389 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 10:50:48,389 - scripts.flask_app - DEBUG - Set PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:50:48,390 - scripts.flask_app - DEBUG - Updated sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:50:48,390 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 10:50:48,394 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 10:50:48,398 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 10:50:48,399 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:50:48,399 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 10:50:48,399 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:50:50,061 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 10:50:50,072 - scripts.flask_app - DEBUG - Set PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:50:50,073 - scripts.flask_app - DEBUG - Updated sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:50:50,073 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 10:50:50,074 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 10:50:50,078 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 10:50:50,082 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 10:50:50,083 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:50:50,083 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 10:50:50,084 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:50:51,768 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 10:50:51,780 - scripts.flask_app - ERROR - Error during model initialization: local variable 'jax' referenced before assignment
2024-06-19 10:50:51,781 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in initialize_model
    app.logger.debug(f"JAX version: {jax.__version__}")  # Log the JAX version for debugging
UnboundLocalError: local variable 'jax' referenced before assignment
 - TIMESTAMP: 2024-06-19T10:50:51.781412
2024-06-19 10:50:51,782 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:50:51,782 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 10:50:51,782 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:50:53,426 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 10:50:53,426 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 10:50:53,438 - scripts.flask_app - ERROR - Error retrieving installed packages: local variable 'jax' referenced before assignment - TIMESTAMP: 2024-06-19T10:50:53.438857
2024-06-19 10:50:53,439 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: local variable 'jax' referenced before assignment - TIMESTAMP: 2024-06-19T10:50:53.439224
2024-06-19 10:50:53,439 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 124, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in initialize_model
    app.logger.debug(f"JAX version: {jax.__version__}")  # Log the JAX version for debugging
UnboundLocalError: local variable 'jax' referenced before assignment
 - TIMESTAMP: 2024-06-19T10:50:53.439854
2024-06-19 10:50:53,440 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T10:50:53.440444
2024-06-19 10:50:53,441 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T10:50:53.441315
2024-06-19 10:50:53,441 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent - TIMESTAMP: 2024-06-19T10:50:53.441647
2024-06-19 10:50:55,083 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T10:50:55.083146
2024-06-19 10:50:55,083 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T10:50:55.083623
2024-06-19 10:50:55,097 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 10:55:07,808 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 10:55:07,809 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 10:55:07,809 - scripts.flask_app - DEBUG - Set PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:55:07,810 - scripts.flask_app - DEBUG - Updated sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:55:07,810 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 10:55:07,813 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 10:55:07,818 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 10:55:07,819 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:55:07,819 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 10:55:07,820 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:55:09,478 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 10:55:09,500 - scripts.flask_app - DEBUG - Set PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:55:09,500 - scripts.flask_app - DEBUG - Updated sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:55:09,501 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 10:55:09,501 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 10:55:09,504 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 10:55:09,509 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 10:55:09,509 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:55:09,510 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 10:55:09,510 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:55:11,307 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 10:55:11,326 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 10:55:11,326 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 10:55:11,440 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 10:55:11,441 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 10:55:11,441 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 10:55:11,441 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 10:55:11,443 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 10:55:11,447 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 10:55:11,447 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 10:55:11,862 - scripts.flask_app - ERROR - Error during model parameter initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 10:55:11,862 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 10:55:11,862 - scripts.flask_app - ERROR - Error during model initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 10:55:11,863 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 76, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 58, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T10:55:11.863937
2024-06-19 10:55:11,864 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:55:11,864 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 10:55:11,864 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:55:14,479 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 10:55:14,479 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 10:55:14,501 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 10:55:14,501 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: VarianceScaling.__init__() got an unexpected keyword argument 'dtype' - TIMESTAMP: 2024-06-19T10:55:14.501699
2024-06-19 10:55:14,502 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 119, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 76, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 58, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T10:55:14.502287
2024-06-19 10:55:14,504 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T10:55:14.504584
2024-06-19 10:55:14,504 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T10:55:14.504943
2024-06-19 10:55:14,505 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent - TIMESTAMP: 2024-06-19T10:55:14.505278
2024-06-19 10:55:16,096 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T10:55:16.096043
2024-06-19 10:55:16,096 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T10:55:16.096557
2024-06-19 10:55:16,115 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 10:58:35,262 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 10:58:35,263 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 10:58:35,264 - scripts.flask_app - DEBUG - Set PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:58:35,264 - scripts.flask_app - DEBUG - Updated sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:58:35,265 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 10:58:35,268 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 10:58:35,274 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 10:58:35,275 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:58:35,275 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 10:58:35,276 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:58:36,927 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 10:58:36,951 - scripts.flask_app - DEBUG - Set PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:58:36,952 - scripts.flask_app - DEBUG - Updated sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:58:36,952 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 10:58:36,953 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 10:58:36,956 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 10:58:36,961 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 10:58:36,961 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:58:36,962 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 10:58:36,962 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:58:38,597 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 10:58:38,622 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 10:58:38,623 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 10:58:38,685 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 10:58:38,686 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 10:58:38,687 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 10:58:38,687 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 10:58:38,688 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 10:58:38,689 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 10:58:38,689 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 10:58:39,078 - scripts.flask_app - ERROR - Error during model parameter initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 10:58:39,078 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 10:58:39,079 - scripts.flask_app - ERROR - Error during model initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 10:58:39,080 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 76, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 58, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T10:58:39.080831
2024-06-19 10:58:39,081 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 10:58:39,081 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 10:58:39,082 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent
2024-06-19 10:58:40,925 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 10:58:40,925 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 10:58:40,931 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 10:58:40,931 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: VarianceScaling.__init__() got an unexpected keyword argument 'dtype' - TIMESTAMP: 2024-06-19T10:58:40.931427
2024-06-19 10:58:40,931 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 119, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 76, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 58, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T10:58:40.931936
2024-06-19 10:58:40,933 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T10:58:40.933008
2024-06-19 10:58:40,933 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T10:58:40.933309
2024-06-19 10:58:40,933 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent:/home/ubuntu/chat-agent:/home/ubuntu/chat-agent - TIMESTAMP: 2024-06-19T10:58:40.933575
2024-06-19 10:58:42,596 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T10:58:42.596087
2024-06-19 10:58:42,596 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T10:58:42.596628
2024-06-19 10:58:42,629 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:05:23,937 - scripts.flask_app - DEBUG - Incoming request data: {'user_id': 'test_user', 'input': 'Hello, chat agent!'}
2024-06-19 11:05:23,938 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:05:23,938 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:05:23,942 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:05:23,947 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:05:23,948 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:05:23,948 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:05:23,948 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent
2024-06-19 11:05:25,592 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:05:25,598 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:05:25,598 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:05:25,602 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:05:25,606 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:05:25,607 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:05:25,608 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:05:25,608 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent
2024-06-19 11:05:27,221 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:05:27,248 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:05:27,248 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:05:27,358 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:05:27,360 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:05:27,360 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:05:27,361 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:05:27,364 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:05:27,365 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:05:27,365 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:05:27,935 - scripts.flask_app - ERROR - Error during model parameter initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:05:27,936 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:05:27,936 - scripts.flask_app - ERROR - Error during model initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:05:27,937 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:05:27.937547
2024-06-19 11:05:27,941 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:05:27,941 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:05:27,942 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent
2024-06-19 11:05:29,583 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:05:29,584 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:05:29,597 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:05:29,598 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: VarianceScaling.__init__() got an unexpected keyword argument 'dtype' - TIMESTAMP: 2024-06-19T11:05:29.598385
2024-06-19 11:05:29,599 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 111, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:05:29.599025
2024-06-19 11:05:29,602 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:05:29.602137
2024-06-19 11:05:29,602 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:05:29.602527
2024-06-19 11:05:29,602 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent - TIMESTAMP: 2024-06-19T11:05:29.602918
2024-06-19 11:05:31,208 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:05:31.208062
2024-06-19 11:05:31,208 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:05:31.208752
2024-06-19 11:05:31,236 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:11:13,767 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, World!'}
2024-06-19 11:11:13,768 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:11:13,768 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:11:13,772 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:11:13,780 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:11:13,781 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:11:13,781 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:11:13,782 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent
2024-06-19 11:11:15,438 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:11:15,466 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:11:15,467 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:11:15,471 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:11:15,475 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:11:15,477 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:11:15,478 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:11:15,478 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent
2024-06-19 11:11:17,372 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:11:17,380 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:11:17,381 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:11:17,520 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:11:17,521 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:11:17,522 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:11:17,523 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:11:17,525 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:11:17,525 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:11:17,526 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:11:17,952 - scripts.flask_app - ERROR - Error during model parameter initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:11:17,952 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:11:17,952 - scripts.flask_app - ERROR - Error during model initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:11:17,954 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:11:17.954051
2024-06-19 11:11:17,955 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:11:17,956 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:11:17,956 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent
2024-06-19 11:11:19,580 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:11:19,580 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:11:19,607 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:11:19,608 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: VarianceScaling.__init__() got an unexpected keyword argument 'dtype' - TIMESTAMP: 2024-06-19T11:11:19.608012
2024-06-19 11:11:19,608 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:11:19.608660
2024-06-19 11:11:19,611 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:11:19.611738
2024-06-19 11:11:19,612 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:11:19.612140
2024-06-19 11:11:19,612 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent - TIMESTAMP: 2024-06-19T11:11:19.612529
2024-06-19 11:11:21,175 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:11:21.175060
2024-06-19 11:11:21,176 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:11:21.175312
2024-06-19 11:11:21,204 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:14:47,599 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, World!'}
2024-06-19 11:14:47,602 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:14:47,603 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:14:47,607 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:14:47,612 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:14:47,612 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:14:47,613 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:14:47,613 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent
2024-06-19 11:14:49,360 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:14:49,360 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:14:49,360 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:14:49,363 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:14:49,369 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:14:49,369 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:14:49,369 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:14:49,369 - scripts.flask_app - DEBUG - Environment PYTHONPATH: /home/ubuntu/chat-agent
2024-06-19 11:14:50,928 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:14:50,929 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:14:50,929 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:14:50,987 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:14:50,987 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:14:50,987 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:14:50,988 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:14:50,989 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:14:50,989 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:14:50,989 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:14:51,386 - scripts.flask_app - ERROR - Error during model parameter initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:14:51,386 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:14:51,387 - scripts.flask_app - ERROR - Error during model initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:14:51,388 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:14:51.388613
2024-06-19 11:14:51,389 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:14:51,389 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:14:51,390 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent
2024-06-19 11:14:52,921 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:14:52,921 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:14:52,922 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:14:52,922 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: VarianceScaling.__init__() got an unexpected keyword argument 'dtype' - TIMESTAMP: 2024-06-19T11:14:52.922389
2024-06-19 11:14:52,922 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 111, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:14:52.922806
2024-06-19 11:14:52,923 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/home/ubuntu/chat-agent', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:14:52.922999
2024-06-19 11:14:52,923 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:14:52.923145
2024-06-19 11:14:52,923 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: /home/ubuntu/chat-agent - TIMESTAMP: 2024-06-19T11:14:52.923287
2024-06-19 11:14:54,473 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:14:54.473249
2024-06-19 11:14:54,473 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
VishwamAI                    0.1
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:14:54.473506
2024-06-19 11:14:54,497 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:20:34,007 - scripts.flask_app - DEBUG - Incoming request data: {'user_id': 'test_user', 'input': 'Hello, how are you?'}
2024-06-19 11:20:34,008 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:20:34,008 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:20:34,011 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:20:34,016 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:20:34,016 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:20:34,016 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:20:34,017 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:20:35,636 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:20:35,639 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:20:35,640 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:20:35,643 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:20:35,647 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:20:35,648 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:20:35,648 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:20:35,648 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:20:37,248 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:20:37,268 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:20:37,269 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:20:37,334 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:20:37,335 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:20:37,336 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:20:37,336 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:20:37,338 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:20:37,338 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:20:37,338 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:20:37,716 - scripts.flask_app - ERROR - Error during model parameter initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:20:37,716 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:20:37,716 - scripts.flask_app - ERROR - Error during model initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:20:37,718 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:20:37.718246
2024-06-19 11:20:37,722 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:20:37,722 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:20:37,722 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 11:20:39,355 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:20:39,356 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:20:39,376 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:20:39,377 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: VarianceScaling.__init__() got an unexpected keyword argument 'dtype' - TIMESTAMP: 2024-06-19T11:20:39.377130
2024-06-19 11:20:39,377 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 111, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:20:39.377737
2024-06-19 11:20:39,380 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:20:39.380030
2024-06-19 11:20:39,380 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:20:39.380386
2024-06-19 11:20:39,380 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T11:20:39.380727
2024-06-19 11:20:41,031 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:20:41.031569
2024-06-19 11:20:41,032 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:20:41.032181
2024-06-19 11:20:41,056 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:25:51,616 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 11:25:51,617 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:25:51,617 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:25:51,620 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:25:51,627 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:25:51,627 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:25:51,628 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:25:51,628 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:25:53,175 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:25:53,201 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:25:53,202 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:25:53,205 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:25:53,210 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:25:53,210 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:25:53,211 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:25:53,211 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:25:54,760 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:25:54,784 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:25:54,784 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:25:54,846 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:25:54,847 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:25:54,848 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:25:54,848 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:25:54,850 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:25:54,851 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:25:54,852 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:25:55,290 - scripts.flask_app - ERROR - Error during model parameter initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:25:55,291 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:25:55,291 - scripts.flask_app - ERROR - Error during model initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:25:55,293 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:25:55.293001
2024-06-19 11:25:55,293 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:25:55,293 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:25:55,294 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 11:25:56,932 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:25:56,933 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:25:56,940 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:25:56,940 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: VarianceScaling.__init__() got an unexpected keyword argument 'dtype' - TIMESTAMP: 2024-06-19T11:25:56.940377
2024-06-19 11:25:56,940 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 111, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:25:56.940833
2024-06-19 11:25:56,941 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:25:56.941834
2024-06-19 11:25:56,942 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:25:56.942186
2024-06-19 11:25:56,942 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T11:25:56.942483
2024-06-19 11:25:58,493 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:25:58.493694
2024-06-19 11:25:58,493 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:25:58.493951
2024-06-19 11:25:58,494 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:32:47,803 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 11:32:47,804 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:32:47,804 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:32:47,808 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:32:47,813 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:32:47,813 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:32:47,814 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:32:47,814 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:32:49,721 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:32:49,748 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:32:49,749 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:32:49,752 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:32:49,757 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:32:49,758 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:32:49,758 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:32:49,759 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:32:51,354 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:32:51,379 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:32:51,380 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:32:51,381 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:32:51,382 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:32:51,382 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:32:51,383 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:32:51,384 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:32:51,384 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:32:51,385 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:32:51,837 - scripts.flask_app - ERROR - Error during model parameter initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:32:51,837 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:32:51,837 - scripts.flask_app - ERROR - Error during model initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:32:51,838 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:32:51.838126
2024-06-19 11:32:51,838 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:32:51,838 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:32:51,838 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 11:32:53,448 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:32:53,449 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:32:53,472 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:32:53,472 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: VarianceScaling.__init__() got an unexpected keyword argument 'dtype' - TIMESTAMP: 2024-06-19T11:32:53.472845
2024-06-19 11:32:53,473 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 111, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 72, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:32:53.473718
2024-06-19 11:32:53,477 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:32:53.477772
2024-06-19 11:32:53,478 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:32:53.478273
2024-06-19 11:32:53,478 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T11:32:53.478712
2024-06-19 11:32:55,031 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:32:55.031893
2024-06-19 11:32:55,032 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:32:55.032146
2024-06-19 11:32:55,032 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:37:25,043 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 11:37:25,044 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:37:25,044 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:37:25,047 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:37:25,052 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:37:25,052 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:37:25,052 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:37:25,052 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:37:27,005 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:37:27,032 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:37:27,032 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:37:27,035 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:37:27,040 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:37:27,040 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:37:27,041 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:37:27,041 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:37:28,544 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:37:28,571 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:37:28,572 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:37:28,630 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:37:28,631 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:37:28,631 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:37:28,632 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:37:28,633 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:37:28,634 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:37:28,634 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:37:29,044 - scripts.flask_app - ERROR - Error during model parameter initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:37:29,046 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:37:29,046 - scripts.flask_app - ERROR - Error during model initialization: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
2024-06-19 11:37:29,048 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:37:29.048387
2024-06-19 11:37:29,051 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:37:29,051 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:37:29,052 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 11:37:30,682 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:37:30,683 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:37:30,710 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:37:30,710 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: VarianceScaling.__init__() got an unexpected keyword argument 'dtype' - TIMESTAMP: 2024-06-19T11:37:30.710879
2024-06-19 11:37:30,711 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 54, in model_fn
    model = VishwamAIModel()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 122, in __call__
    init(module, *args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 30, in __init__
    w_init=hk.initializers.VarianceScaling(1.0, "fan_avg", dtype=jnp.float32)
TypeError: VarianceScaling.__init__() got an unexpected keyword argument 'dtype'
 - TIMESTAMP: 2024-06-19T11:37:30.711537
2024-06-19 11:37:30,714 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:37:30.714595
2024-06-19 11:37:30,715 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:37:30.714977
2024-06-19 11:37:30,715 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T11:37:30.715405
2024-06-19 11:37:32,314 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:37:32.314928
2024-06-19 11:37:32,315 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:37:32.315551
2024-06-19 11:37:32,349 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:43:18,124 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 11:43:18,124 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:43:18,124 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:43:18,137 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:43:18,147 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:43:18,147 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:43:18,148 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:43:18,148 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:43:19,829 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:43:19,836 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:43:19,836 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:43:19,839 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:43:19,844 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:43:19,844 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:43:19,845 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:43:19,845 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:43:21,760 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:43:21,766 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:43:21,766 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:43:21,829 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:43:21,830 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:43:21,830 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:43:21,830 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:43:21,834 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:43:21,834 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:43:21,835 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:43:31,578 - scripts.flask_app - ERROR - Error during model parameter initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 11:43:31,579 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:43:31,579 - scripts.flask_app - ERROR - Error during model initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 11:43:31,585 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T11:43:31.585103
2024-06-19 11:43:31,591 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:43:31,591 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:43:31,592 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 11:43:33,623 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:43:33,624 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:43:33,653 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:43:33,653 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: Unable to convert output to JAX tensors format, JAX is not installed. - TIMESTAMP: 2024-06-19T11:43:33.653696
2024-06-19 11:43:33,654 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T11:43:33.654620
2024-06-19 11:43:33,660 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:43:33.660776
2024-06-19 11:43:33,661 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:43:33.661247
2024-06-19 11:43:33,661 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T11:43:33.661722
2024-06-19 11:43:35,267 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:43:35.267742
2024-06-19 11:43:35,268 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:43:35.268429
2024-06-19 11:43:35,300 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:48:15,706 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 11:48:15,706 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:48:15,707 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:48:15,710 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:48:15,714 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:48:15,714 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:48:15,715 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:48:15,715 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:48:17,479 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:48:17,481 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:48:17,481 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:48:17,484 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:48:17,489 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:48:17,489 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:48:17,489 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:48:17,490 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:48:19,093 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:48:19,095 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:48:19,095 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:48:19,097 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:48:19,097 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:48:19,098 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:48:19,098 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:48:19,099 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:48:19,099 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:48:19,100 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:48:23,556 - scripts.flask_app - ERROR - Error during model parameter initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 11:48:23,557 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:48:23,557 - scripts.flask_app - ERROR - Error during model initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 11:48:23,558 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T11:48:23.558904
2024-06-19 11:48:23,560 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:48:23,560 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:48:23,560 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 11:48:25,166 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:48:25,166 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:48:25,192 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:48:25,193 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: Unable to convert output to JAX tensors format, JAX is not installed. - TIMESTAMP: 2024-06-19T11:48:25.193208
2024-06-19 11:48:25,194 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T11:48:25.194111
2024-06-19 11:48:25,199 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:48:25.199680
2024-06-19 11:48:25,200 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:48:25.200156
2024-06-19 11:48:25,200 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T11:48:25.200610
2024-06-19 11:48:26,801 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:48:26.801268
2024-06-19 11:48:26,802 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:48:26.802002
2024-06-19 11:48:26,828 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:56:39,958 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 11:56:39,959 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 11:56:39,959 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:56:39,962 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:56:39,969 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:56:39,970 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:56:39,970 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:56:39,971 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:56:41,617 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:56:41,649 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 11:56:41,649 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 11:56:41,653 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 11:56:41,658 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 11:56:41,659 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:56:41,659 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:56:41,660 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 11:56:43,217 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:56:43,249 - scripts.flask_app - DEBUG - JAX version: 0.4.10
2024-06-19 11:56:43,250 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 11:56:43,312 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 11:56:43,313 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 11:56:43,314 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 11:56:43,314 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 11:56:43,316 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:56:43,316 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 11:56:43,317 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 11:56:52,340 - scripts.flask_app - ERROR - Error during model parameter initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 11:56:52,340 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 11:56:52,341 - scripts.flask_app - ERROR - Error during model initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 11:56:52,345 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T11:56:52.345572
2024-06-19 11:56:52,348 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 11:56:52,348 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 11:56:52,348 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 11:56:53,914 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 11:56:53,915 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 11:56:53,946 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 11:56:53,946 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: Unable to convert output to JAX tensors format, JAX is not installed. - TIMESTAMP: 2024-06-19T11:56:53.946680
2024-06-19 11:56:53,947 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T11:56:53.947569
2024-06-19 11:56:53,954 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T11:56:53.954578
2024-06-19 11:56:53,955 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T11:56:53.955011
2024-06-19 11:56:53,955 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T11:56:53.955445
2024-06-19 11:56:55,526 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T11:56:55.526884
2024-06-19 11:56:55,527 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T11:56:55.527530
2024-06-19 11:56:55,559 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:01:07,480 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 12:01:07,481 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 12:01:07,481 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:01:07,485 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:01:07,490 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:01:07,491 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:01:07,491 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:01:07,492 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:01:09,116 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:01:09,141 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 12:01:09,142 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:01:09,145 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:01:09,149 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:01:09,150 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:01:09,150 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:01:09,151 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:01:10,765 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:01:10,794 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 12:01:10,857 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 12:01:10,858 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 12:01:10,858 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 12:01:10,858 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 12:01:10,860 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:01:10,860 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:01:10,861 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 12:01:20,402 - scripts.flask_app - ERROR - Error during model parameter initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:01:20,403 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 12:01:20,403 - scripts.flask_app - ERROR - Error during model initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:01:20,406 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:01:20.406330
2024-06-19 12:01:20,412 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:01:20,412 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:01:20,412 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 12:01:22,060 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 12:01:22,061 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:01:22,086 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:01:22,087 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: Unable to convert output to JAX tensors format, JAX is not installed. - TIMESTAMP: 2024-06-19T12:01:22.087000
2024-06-19 12:01:22,088 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:01:22.088055
2024-06-19 12:01:22,094 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T12:01:22.094262
2024-06-19 12:01:22,094 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T12:01:22.094758
2024-06-19 12:01:22,095 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T12:01:22.095209
2024-06-19 12:01:23,695 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T12:01:23.695418
2024-06-19 12:01:23,695 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T12:01:23.695674
2024-06-19 12:01:23,722 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:10:28,499 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 12:10:28,500 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 12:10:28,501 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:10:28,504 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:10:28,508 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:10:28,509 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:10:28,509 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:10:28,510 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:10:30,047 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:10:30,066 - scripts.flask_app - DEBUG - JAX import check: <module 'jax' from '/home/ubuntu/.local/lib/python3.10/site-packages/jax/__init__.py'>
2024-06-19 12:10:30,067 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 12:10:30,067 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:10:30,071 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:10:30,075 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:10:30,076 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:10:30,076 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:10:30,076 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:10:31,617 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:10:31,637 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 12:10:31,700 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 12:10:31,701 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 12:10:31,701 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 12:10:31,702 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 12:10:31,703 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:10:31,704 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:10:31,704 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 12:10:40,678 - scripts.flask_app - ERROR - Error during model parameter initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:10:40,678 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 12:10:40,678 - scripts.flask_app - ERROR - Error during model initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:10:40,681 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:10:40.681797
2024-06-19 12:10:40,682 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:10:40,682 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:10:40,683 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 12:10:42,318 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 12:10:42,318 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:10:42,318 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:10:42,318 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: Unable to convert output to JAX tensors format, JAX is not installed. - TIMESTAMP: 2024-06-19T12:10:42.318947
2024-06-19 12:10:42,319 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:10:42.319715
2024-06-19 12:10:42,319 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T12:10:42.319963
2024-06-19 12:10:42,320 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T12:10:42.320096
2024-06-19 12:10:42,320 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T12:10:42.320308
2024-06-19 12:10:43,856 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T12:10:43.856265
2024-06-19 12:10:43,856 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T12:10:43.856521
2024-06-19 12:10:43,856 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:14:36,031 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 12:14:36,032 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 12:14:36,032 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:14:36,035 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:14:36,041 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:14:36,041 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:14:36,042 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:14:36,042 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:14:37,663 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:14:37,667 - scripts.flask_app - DEBUG - JAX import check: <module 'jax' from '/home/ubuntu/.local/lib/python3.10/site-packages/jax/__init__.py'>
2024-06-19 12:14:37,667 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 12:14:37,667 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:14:37,673 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:14:37,678 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:14:37,679 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:14:37,679 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:14:37,679 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:14:39,302 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:14:39,305 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 12:14:39,377 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 12:14:39,377 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 12:14:39,377 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 12:14:39,378 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 12:14:39,379 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:14:39,379 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:14:39,379 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 12:14:48,493 - scripts.flask_app - ERROR - Error during model parameter initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:14:48,493 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 12:14:48,493 - scripts.flask_app - ERROR - Error during model initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:14:48,496 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:14:48.496249
2024-06-19 12:14:48,496 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:14:48,496 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:14:48,496 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 12:14:50,075 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 12:14:50,075 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:14:50,103 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:14:50,103 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: Unable to convert output to JAX tensors format, JAX is not installed. - TIMESTAMP: 2024-06-19T12:14:50.103511
2024-06-19 12:14:50,104 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:14:50.104360
2024-06-19 12:14:50,110 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T12:14:50.110873
2024-06-19 12:14:50,111 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T12:14:50.111290
2024-06-19 12:14:50,111 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T12:14:50.111717
2024-06-19 12:14:52,067 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T12:14:52.067595
2024-06-19 12:14:52,068 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T12:14:52.067855
2024-06-19 12:14:52,093 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:18:25,595 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 12:18:25,595 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 12:18:25,596 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:18:25,599 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:18:25,604 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:18:25,604 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:18:25,604 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:18:25,604 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:18:27,088 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:18:27,112 - scripts.flask_app - DEBUG - JAX import check: <module 'jax' from '/home/ubuntu/.local/lib/python3.10/site-packages/jax/__init__.py'>
2024-06-19 12:18:27,112 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 12:18:27,113 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:18:27,116 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:18:27,121 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:18:27,121 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:18:27,122 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:18:27,122 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:18:28,635 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:18:28,662 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 12:18:28,663 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 12:18:28,664 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 12:18:28,664 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 12:18:28,665 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 12:18:28,666 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:18:28,666 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:18:28,666 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 12:18:32,813 - scripts.flask_app - ERROR - Error during model parameter initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:18:32,814 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 12:18:32,814 - scripts.flask_app - ERROR - Error during model initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:18:32,815 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:18:32.815580
2024-06-19 12:18:32,820 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:18:32,821 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:18:32,821 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 12:18:34,738 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 12:18:34,739 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:18:34,763 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:18:34,763 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: Unable to convert output to JAX tensors format, JAX is not installed. - TIMESTAMP: 2024-06-19T12:18:34.763763
2024-06-19 12:18:34,764 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:18:34.764657
2024-06-19 12:18:34,770 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T12:18:34.770339
2024-06-19 12:18:34,770 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T12:18:34.770887
2024-06-19 12:18:34,771 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T12:18:34.771358
2024-06-19 12:18:36,681 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T12:18:36.681197
2024-06-19 12:18:36,683 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T12:18:36.681461
2024-06-19 12:18:36,706 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:21:43,504 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 12:21:43,504 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 12:21:43,504 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:21:43,508 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:21:43,513 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:21:43,513 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:21:43,513 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:21:43,513 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:21:45,152 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:21:45,178 - scripts.flask_app - DEBUG - JAX import check: <module 'jax' from '/home/ubuntu/.local/lib/python3.10/site-packages/jax/__init__.py'>
2024-06-19 12:21:45,179 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 12:21:45,179 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:21:45,183 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:21:45,187 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:21:45,188 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:21:45,188 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:21:45,189 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:21:46,871 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:21:46,897 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 12:21:46,904 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 12:21:46,905 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 12:21:46,905 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 12:21:46,906 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 12:21:46,907 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:21:46,908 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:21:46,908 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 12:21:51,432 - scripts.flask_app - ERROR - Error during model parameter initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:21:51,432 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 12:21:51,432 - scripts.flask_app - ERROR - Error during model initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:21:51,433 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:21:51.433500
2024-06-19 12:21:51,433 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:21:51,433 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:21:51,434 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 12:21:53,035 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 12:21:53,035 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:21:53,036 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:21:53,036 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: Unable to convert output to JAX tensors format, JAX is not installed. - TIMESTAMP: 2024-06-19T12:21:53.036369
2024-06-19 12:21:53,036 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 112, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:21:53.036935
2024-06-19 12:21:53,037 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T12:21:53.037184
2024-06-19 12:21:53,037 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T12:21:53.037320
2024-06-19 12:21:53,037 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T12:21:53.037449
2024-06-19 12:21:54,607 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T12:21:54.607685
2024-06-19 12:21:54,607 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T12:21:54.607937
2024-06-19 12:21:54,608 - scripts.flask_app - ERROR - JAX version during error: 0.4.10
2024-06-19 12:33:18,339 - scripts.flask_app - DEBUG - Incoming request data: {'message': 'Hello, how are you?'}
2024-06-19 12:33:18,339 - scripts.flask_app - DEBUG - Test log entry: /chat endpoint hit
2024-06-19 12:33:18,340 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:33:18,343 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:33:18,348 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:33:18,349 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:33:18,349 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:33:18,349 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:33:19,963 - scripts.flask_app - DEBUG - Installed packages before request handling: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:33:19,967 - scripts.flask_app - DEBUG - JAX import check: <module 'jax' from '/home/ubuntu/.local/lib/python3.10/site-packages/jax/__init__.py'>
2024-06-19 12:33:19,967 - scripts.flask_app - DEBUG - Starting model initialization...
2024-06-19 12:33:19,967 - scripts.flask_app - DEBUG - Python interpreter: /usr/bin/python3
2024-06-19 12:33:19,971 - scripts.flask_app - DEBUG - Python interpreter path: /usr/bin/python3
2024-06-19 12:33:19,975 - scripts.flask_app - DEBUG - Python version: Python 3.10.12
2024-06-19 12:33:19,975 - scripts.flask_app - DEBUG - sys.path: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:33:19,976 - scripts.flask_app - DEBUG - Environment PATH: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:33:19,976 - scripts.flask_app - DEBUG - Environment PYTHONPATH: 
2024-06-19 12:33:21,573 - scripts.flask_app - DEBUG - Installed packages before initialization: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:33:21,577 - scripts.flask_app - DEBUG - Initializing model...
2024-06-19 12:33:21,640 - scripts.flask_app - DEBUG - Example input: ['This is a dummy input for model initialization.']
2024-06-19 12:33:21,641 - scripts.flask_app - DEBUG - Initializing model with input: ['This is a dummy input for model initialization.']
2024-06-19 12:33:21,641 - scripts.flask_app - DEBUG - Type of example input: <class 'list'>
2024-06-19 12:33:21,642 - scripts.flask_app - DEBUG - Content of example input: ['This is a dummy input for model initialization.']
2024-06-19 12:33:21,643 - scripts.flask_app - DEBUG - Tokenized input before JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:33:21,643 - scripts.flask_app - DEBUG - Tokenized input after JAX conversion: [[1212, 318, 257, 31548, 5128, 329, 2746, 37588, 13]]
2024-06-19 12:33:21,644 - scripts.flask_app - DEBUG - Dtype of tokenized input: <class 'int'>
2024-06-19 12:33:30,398 - scripts.flask_app - ERROR - Error during model parameter initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:33:30,398 - scripts.flask_app - ERROR - Input during initialization error: ['This is a dummy input for model initialization.']
2024-06-19 12:33:30,398 - scripts.flask_app - ERROR - Error during model initialization: Unable to convert output to JAX tensors format, JAX is not installed.
2024-06-19 12:33:30,403 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:33:30.403838
2024-06-19 12:33:30,408 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages']
2024-06-19 12:33:30,409 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin
2024-06-19 12:33:30,409 - scripts.flask_app - ERROR - Environment PYTHONPATH during error: 
2024-06-19 12:33:31,982 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3
2024-06-19 12:33:31,982 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0

2024-06-19 12:33:32,018 - scripts.flask_app - ERROR - CHAT_ENDPOINT_ERROR: Unable to convert output to JAX tensors format, JAX is not installed. - TIMESTAMP: 2024-06-19T12:33:32.018495
2024-06-19 12:33:32,019 - scripts.flask_app - ERROR - Stack trace: Traceback (most recent call last):
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 110, in chat
    initialize_model()
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 73, in initialize_model
    params = transformed_model_fn.init(rng, tokenized_input)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 114, in init_fn
    params, state = f.init(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/transform.py", line 338, in init_fn
    f(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/flask_app.py", line 55, in model_fn
    return model(inputs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 101, in __call__
    attention_output = self.advanced_features(hidden_states)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 426, in wrapped
    out = f(*args, **kwargs)
  File "/usr/lib/python3.10/contextlib.py", line 79, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/haiku/_src/module.py", line 272, in run_interceptors
    return bound_method(*args, **kwargs)
  File "/home/ubuntu/chat-agent/scripts/model_architecture.py", line 157, in __call__
    input_ids = self.tokenizer(inputs, return_tensors="jax").input_ids
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2883, in __call__
    encodings = self._call_one(text=text, text_pair=text_pair, **all_kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 2969, in _call_one
    return self.batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 3160, in batch_encode_plus
    return self._batch_encode_plus(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 807, in _batch_encode_plus
    batch_outputs = self._batch_prepare_for_model(
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils.py", line 887, in _batch_prepare_for_model
    batch_outputs = BatchEncoding(batch_outputs, tensor_type=return_tensors)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 224, in __init__
    self.convert_to_tensors(tensor_type=tensor_type, prepend_batch_axis=prepend_batch_axis)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/transformers/tokenization_utils_base.py", line 725, in convert_to_tensors
    raise ImportError("Unable to convert output to JAX tensors format, JAX is not installed.")
ImportError: Unable to convert output to JAX tensors format, JAX is not installed.
 - TIMESTAMP: 2024-06-19T12:33:32.019592
2024-06-19 12:33:32,027 - scripts.flask_app - ERROR - sys.path during error: ['/home/ubuntu/chat-agent', '/home/ubuntu/.local/bin', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/ubuntu/.local/lib/python3.10/site-packages', '/usr/local/lib/python3.10/dist-packages', '/usr/lib/python3/dist-packages'] - TIMESTAMP: 2024-06-19T12:33:32.027312
2024-06-19 12:33:32,027 - scripts.flask_app - ERROR - Environment PATH during error: /opt/.devin/package/custom_binaries:/home/ubuntu/.local/bin:/home/ubuntu/.cargo/bin:/opt/.devin/package/custom_binaries:/home/ubuntu/.nvm/versions/node/v18.19.0/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/ubuntu/.local/share/coursier/bin - TIMESTAMP: 2024-06-19T12:33:32.027946
2024-06-19 12:33:32,028 - scripts.flask_app - ERROR - Environment PYTHONPATH during error:  - TIMESTAMP: 2024-06-19T12:33:32.028423
2024-06-19 12:33:33,600 - scripts.flask_app - ERROR - Python interpreter: /usr/bin/python3 - TIMESTAMP: 2024-06-19T12:33:33.600699
2024-06-19 12:33:33,601 - scripts.flask_app - ERROR - Installed packages: Package                      Version
---------------------------- ----------------
absl-py                      2.1.0
altair                       5.2.0
astunparse                   1.6.3
attrs                        21.2.0
Automat                      20.2.0
awscli                       1.22.34
Babel                        2.8.0
bcrypt                       3.2.0
beautifulsoup4               4.12.3
blinker                      1.8.2
botocore                     1.23.34
branca                       0.7.1
cachetools                   5.3.2
certifi                      2024.6.2
chardet                      4.0.0
charset-normalizer           3.3.2
click                        8.1.7
cloud-init                   24.1.3
colorama                     0.4.4
command-not-found            0.3
configobj                    5.0.6
constantly                   15.1.0
contourpy                    1.2.0
cryptography                 3.4.8
cycler                       0.12.1
dbus-python                  1.2.18
distro                       1.7.0
distro-info                  1.1+ubuntu0.2
dm-haiku                     0.0.9
docker                       5.0.3
docker-compose               1.29.2
dockerpty                    0.4.1
docopt                       0.6.2
docutils                     0.17.1
ec2-hibinit-agent            1.0.0
filelock                     3.15.1
Flask                        3.0.3
flatbuffers                  24.3.25
folium                       0.15.1
fonttools                    4.48.1
fsspec                       2024.6.0
gast                         0.4.0
gitdb                        4.0.11
GitPython                    3.1.41
google-auth                  2.30.0
google-auth-oauthlib         1.0.0
google-pasta                 0.2.0
greenlet                     3.0.3
grpcio                       1.64.1
h5py                         3.11.0
hibagent                     1.0.1
httplib2                     0.20.2
huggingface-hub              0.23.3
hyperlink                    21.0.0
idna                         3.7
importlib-metadata           4.6.4
incremental                  21.3.0
itsdangerous                 2.2.0
jax                          0.4.10
jaxlib                       0.4.10
jeepney                      0.7.1
Jinja2                       3.1.4
jmespath                     0.10.0
jmp                          0.0.4
joblib                       1.3.2
jsonpatch                    1.32
jsonpointer                  2.0
jsonschema                   3.2.0
keras                        2.13.1
keyring                      23.5.0
kiwisolver                   1.4.5
launchpadlib                 1.10.16
lazr.restfulclient           0.14.4
lazr.uri                     1.0.6
libclang                     18.1.1
Markdown                     3.6
markdown-it-py               3.0.0
MarkupSafe                   2.1.5
matplotlib                   3.8.2
mdurl                        0.1.2
ml-dtypes                    0.2.0
more-itertools               8.10.0
mpmath                       1.3.0
namex                        0.0.8
netifaces                    0.11.0
networkx                     2.8.8
numpy                        1.24.3
nvidia-cublas-cu12           12.1.3.1
nvidia-cuda-cupti-cu12       12.1.105
nvidia-cuda-nvrtc-cu12       12.1.105
nvidia-cuda-runtime-cu12     12.1.105
nvidia-cudnn-cu12            8.9.2.26
nvidia-cufft-cu12            11.0.2.54
nvidia-curand-cu12           10.3.2.106
nvidia-cusolver-cu12         11.4.5.107
nvidia-cusparse-cu12         12.1.0.106
nvidia-nccl-cu12             2.20.5
nvidia-nvjitlink-cu12        12.5.40
nvidia-nvtx-cu12             12.1.105
oauthlib                     3.2.0
olefile                      0.46
onnx                         1.16.1
onnx2keras                   0.0.23
opt-einsum                   3.3.0
optree                       0.11.0
packaging                    24.1
pandas                       2.2.0
pexpect                      4.8.0
pillow                       10.3.0
pip                          22.0.2
playwright                   1.41.1
protobuf                     3.20.3
ptyprocess                   0.7.0
pyarrow                      15.0.0
pyasn1                       0.4.8
pyasn1-modules               0.2.1
pydeck                       0.8.1b0
pyee                         11.0.1
Pygments                     2.18.0
PyGObject                    3.42.1
PyHamcrest                   2.0.2
pyinotify                    0.9.6
PyJWT                        2.3.0
pyOpenSSL                    21.0.0
pyparsing                    2.4.7
pyrsistent                   0.18.1
pyserial                     3.5
python-apt                   2.4.0+ubuntu3
python-dateutil              2.8.2
python-debian                0.1.43+ubuntu1.1
python-dotenv                0.19.2
python-magic                 0.4.24
pytz                         2022.1
PyYAML                       6.0.1
regex                        2024.5.15
requests                     2.32.3
requests-oauthlib            2.0.0
rich                         13.7.1
roman                        3.3
rsa                          4.8
s3transfer                   0.5.0
safetensors                  0.4.3
scikit-learn                 1.4.0
scipy                        1.10.1
seaborn                      0.13.2
SecretStorage                3.3.1
service-identity             18.1.0
setuptools                   59.6.0
simplejson                   3.17.6
six                          1.16.0
smmap                        5.0.1
sos                          4.5.6
soupsieve                    2.5
ssh-import-id                5.11
streamlit                    1.31.0
sympy                        1.12.1
systemd-python               234
tabulate                     0.9.0
tenacity                     8.2.3
tensorboard                  2.13.0
tensorboard-data-server      0.7.2
tensorflow                   2.13.1
tensorflow-estimator         2.13.0
tensorflow-io-gcs-filesystem 0.31.0
termcolor                    2.4.0
texttable                    1.6.4
threadpoolctl                3.2.0
timeout-decorator            0.5.0
tokenizers                   0.19.1
toml                         0.10.2
toolz                        0.12.1
tornado                      6.4
tqdm                         4.66.4
transformers                 4.41.2
triton                       2.3.1
Twisted                      22.1.0
typing_extensions            4.5.0
tzdata                       2023.4
tzlocal                      5.2
ubuntu-advantage-tools       8001
ufw                          0.36.1
urllib3                      2.2.2
validators                   0.22.0
wadllib                      1.3.6
watchdog                     4.0.0
websocket-client             1.2.3
Werkzeug                     3.0.3
wheel                        0.37.1
wrapt                        1.16.0
xyzservices                  2023.10.1
zipp                         1.0.0
zope.interface               5.4.0
 - TIMESTAMP: 2024-06-19T12:33:33.601401
